<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CASA0023 Remote Sensing - Learning Diary - 5&nbsp; Google Earth Engine</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./4_policy_applications.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./5_google_earth_engine.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CASA0023 Remote Sensing - Learning Diary</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Remote Sensing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_portfolio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Portfolio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_data_corrections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Remote Sensing Data and Corrections</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_policy_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_google_earth_engine.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-5-summary" id="toc-sec-5-summary" class="nav-link active" data-scroll-target="#sec-5-summary"><span class="header-section-number">5.1</span> Summary</a>
  <ul class="collapse">
  <li><a href="#sec-5-terminology" id="toc-sec-5-terminology" class="nav-link" data-scroll-target="#sec-5-terminology"><span class="header-section-number">5.1.1</span> Terminology</a></li>
  <li><a href="#sec-5-ssprocessing" id="toc-sec-5-ssprocessing" class="nav-link" data-scroll-target="#sec-5-ssprocessing"><span class="header-section-number">5.1.2</span> Server side processing</a></li>
  <li><a href="#sec-5-speed" id="toc-sec-5-speed" class="nav-link" data-scroll-target="#sec-5-speed"><span class="header-section-number">5.1.3</span> Processing Speed</a></li>
  </ul></li>
  <li><a href="#sec-5-application" id="toc-sec-5-application" class="nav-link" data-scroll-target="#sec-5-application"><span class="header-section-number">5.2</span> Application</a></li>
  <li><a href="#sec-5-reflection" id="toc-sec-5-reflection" class="nav-link" data-scroll-target="#sec-5-reflection"><span class="header-section-number">5.3</span> Reflection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-5-summary" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-5-summary"><span class="header-section-number">5.1</span> Summary</h2>
<p>Google Earth Engine (GEE) is a cloud product specifically for geospatial analysis. It combines a huge catalogue of satellite and geospatial data with a platform for simplified analysis with the benefit of using Google computational power for data processing at large scale (<span class="citation" data-cites="google2024">Google (<a href="references.html#ref-google2024" role="doc-biblioref">2024</a>)</span>). A key part of GEE is that it is designed to make sharing of results and reproducibility easy for researchers with only limited technical expertise (<span class="citation" data-cites="gorelick2017">Gorelick et al. (<a href="references.html#ref-gorelick2017" role="doc-biblioref">2017</a>)</span>). GEE provides both a code engine environment and a Python based API that enables automation of process.</p>
<p>We will briefly look at a few of the main advantages/limitations of GEE in this section but the full range of benefits are too numerous to cover here so are summarised in <a href="#fig-gee_adv_lim">Figure&nbsp;<span>5.1</span></a> along with some of the limitations.</p>
<div id="fig-gee_adv_lim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/gee_advantages_limitations.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Google Earth Engine main advantages and limitatations of big-geo data processing. <strong><span class="citation" data-cites="amani2020">Amani et al. (<a href="references.html#ref-amani2020" role="doc-biblioref">2020</a>)</span></strong></figcaption>
</figure>
</div>
<section id="sec-5-terminology" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="sec-5-terminology"><span class="header-section-number">5.1.1</span> Terminology</h3>
<p>At a very basic level there are some terminology and functions that differ to that which we are used to in other remote sensing applications (<a href="#tbl-gee-terminology">Table&nbsp;<span>5.1</span></a>). However this is a relatively minor issue although it could still cause initial confusion and put users off persevering with GEE despite the huge benefits it can bring. Thankfully there is very comprehensive user guides and tutorials available from Google. Also due to the popularity of GEE there is huge amount user-derived content available.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-gee-terminology" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;5.1: Comparison of Remote Sensing and GEE Terminology</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">Remote Sensing Term/function</th>
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">GEE Equivalent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Raster</td>
<td style="text-align: left;">Image</td>
</tr>
<tr class="even">
<td style="text-align: left;">Image Stack</td>
<td style="text-align: left;">ImageCollection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vector</td>
<td style="text-align: left;">Feature</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vector data</td>
<td style="text-align: left;">FeatureCollection</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Join</td>
<td style="text-align: left;">.distFilter, .spatialFilter</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
<section id="sec-5-ssprocessing" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="sec-5-ssprocessing"><span class="header-section-number">5.1.2</span> Server side processing</h3>
<p>Rather than running locally, GEE uses server-side processing to leverage Google’s cloud computing power. This reduces hardware limitations and allows for scalability, often using parallel processing. However, this passes management of the execution process to Google, meaning users have limited visibility and control over optimisation. Whilst this is not an issue for most users, expert researchers who require full control over computational workflows may find this restrictive.</p>
</section>
<section id="sec-5-speed" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="sec-5-speed"><span class="header-section-number">5.1.3</span> Processing Speed</h3>
<p>Specifically looking at time savings that can be made by harnessing the computational power of GEE. <span class="citation" data-cites="hansen2013">Hansen et al. (<a href="references.html#ref-hansen2013" role="doc-biblioref">2013</a>)</span> states that it took 100 hours to process ~707 terrabytes of Landsat images for global forest change detection in GEE. Without cloud-based processing it would have taken a million hours (<span class="citation" data-cites="amani2020">Amani et al. (<a href="references.html#ref-amani2020" role="doc-biblioref">2020</a>)</span>). That does not even account for the process of retrieval, preparation and storage of those images. For many organisations this wouldn’t even be feasible to process without GEE’s cloud infrastructure.</p>
</section>
</section>
<section id="sec-5-application" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-5-application"><span class="header-section-number">5.2</span> Application</h2>
<p>One critique that could be aimed at GEE apps is that they do not always analyse the use case they demonstrate. However considering the openness and availability of GEE it cannot be considered as just an academic tool but also an operational one (<span class="citation" data-cites="kumar2018">Kumar and Mutanga (<a href="references.html#ref-kumar2018" role="doc-biblioref">2018</a>)</span>). In fact it provides a very simple way to quickly build an application to raise awareness/profile of a global issue whilst providing the tools for further research into the cause at a local level.</p>
<p>In a key example of a GEE application, Global Forest Change (<a href="#fig-forest">Figure&nbsp;<span>5.2</span></a>) we clearly see the forest loss across the globe. However the app itself despite showing a few case study example locations does not identify any deeper cause of forest change. The associated article (<span class="citation" data-cites="hansen2013">Hansen et al. (<a href="references.html#ref-hansen2013" role="doc-biblioref">2013</a>)</span>) however does provide some possible causes, again in a subset of locations. When considering the global extents and the sheer number of factors including local policies that affect localised forest change this is not necessarily surprising. For academics or researchers this provides the background and visualisations to highlight specific areas of concerns and to focus deeper research and analysis in these areas. Whilst for a non-academic audience it provides the tools to focus resources in the right locations without needing to research and develop the potentially costly tools themselves. This is evident in areas like the Amazon rainforest where Hansen et al’s work has been used to fight illegal deforestation (<span class="citation" data-cites="gonzales2019">Gonzales (<a href="references.html#ref-gonzales2019" role="doc-biblioref">2019</a>)</span>).</p>
<div id="fig-forest" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="iframe">
<iframe src="https://glad.earthengine.app/view/global-forest-change#bl=off;old=off;dl=1;lon=20;lat=10;zoom=3;;" width="100%" height="600" style="border: none;">
</iframe>
</div>
<figcaption class="figure-caption">Figure&nbsp;5.2: Global Forest Change Viewer. <strong>Source:</strong> <span class="citation" data-cites="glad">Global Land Discovery and Analysis (<a href="references.html#ref-glad" role="doc-biblioref">n.d.</a>)</span></figcaption>
</figure>
</div>
<p>Clearly GEE is useful for analysis that occurs over time but what where near real-time information is required such as in disaster management. The user is constrained to the revisit time of the data supplied by GEE, such as Landsat ~16 days or Sentinel-2 ~5 days. Whilst it is still key to analyse pre and post-disaster imagery such as available through HazMapper (<span class="citation" data-cites="scheip2021">Scheip and Wegmann (<a href="references.html#ref-scheip2021" role="doc-biblioref">2021</a>)</span>) it does not provide the real-time data that can make the difference in effective disaster management. In such instances use of commercially available SAR data (to prevent cloud cover issues) with a lower revisit time could be preferred. The issue with this is the response is often proportional to the available resources for that area, so less affluent and lower profile areas may not have resources to provide access this data (<span class="citation" data-cites="scheip2021">Scheip and Wegmann (<a href="references.html#ref-scheip2021" role="doc-biblioref">2021</a>)</span>), therefore tools such as HazMapper may be the only way to aid management of the disaster so are priceless in these instances.</p>
</section>
<section id="sec-5-reflection" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-5-reflection"><span class="header-section-number">5.3</span> Reflection</h2>
<p>GEE is undoubtedly an exceptional tool which is a great enabler for remote sensing analysis but also of data visualisation with the ease at which apps can be built and published. I’m really looking forward to delving deeper into GEE functionality over the coming weeks and in particularly building applications. Taking this further I’d like to harness the computational power of GEE to identify tree cover and vegetation health in London and the affects this has on air quality. Also to use this to as the basis to explore what measures are effective in improving air quality. This would also help to investigate how useful GEE is “out the box” to deal with issues at a more localised level. In <a href="#fig-gee_adv_lim">Figure&nbsp;<span>5.1</span></a> we saw some limitations including only allowing 250gb of user data so if we wanted to use very hi-res commercial satellite data within GEE then this will cause issues especially if wanted to be produce time series analysis that would be especially useful in the use case mentioned.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-amani2020" class="csl-entry" role="listitem">
Amani, Meisam, Arsalan Ghorbanian, Seyed Ali Ahmadi, Mohammad Kakooei, Armin Moghimi, S. Mohammad Mirmazloumi, Sayyed Hamed Alizadeh Moghaddam, et al. 2020. <span>“Google <span>Earth Engine Cloud Computing Platform</span> for <span>Remote Sensing Big Data Applications</span>: <span>A Comprehensive Review</span>.”</span> <em>IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</em> 13: 5326–50. <a href="https://doi.org/10.1109/JSTARS.2020.3021052">https://doi.org/10.1109/JSTARS.2020.3021052</a>.
</div>
<div id="ref-glad" class="csl-entry" role="listitem">
Global Land Discovery and Analysis. n.d. <span>“Global <span>Forest Change</span>.”</span> Accessed March 2, 2025. <a href="https://glad.earthengine.app/view/global-forest-change#bl=off;old=off;dl=1;lon=20;lat=10;zoom=3;">https://glad.earthengine.app/view/global-forest-change#bl=off;old=off;dl=1;lon=20;lat=10;zoom=3;</a>
</div>
<div id="ref-gonzales2019" class="csl-entry" role="listitem">
Gonzales, Jenny. 2019. <span>“How a Sheriff in <span>Brazil</span> Is Using Satellites to Stop Deforestation.”</span> Mongabay Environmental News. April 12, 2019. <a href="https://news.mongabay.com/2019/04/how-a-sheriff-in-brazil-is-using-satellites-to-stop-deforestation/">https://news.mongabay.com/2019/04/how-a-sheriff-in-brazil-is-using-satellites-to-stop-deforestation/</a>.
</div>
<div id="ref-google2024" class="csl-entry" role="listitem">
Google. 2024. <span>“About <span>Google Earth Engine</span>.”</span> Google for Developers. 2024. <a href="https://developers.google.com/earth-engine/guides">https://developers.google.com/earth-engine/guides</a>.
</div>
<div id="ref-gorelick2017" class="csl-entry" role="listitem">
Gorelick, Noel, Matt Hancher, Mike Dixon, Simon Ilyushchenko, David Thau, and Rebecca Moore. 2017. <span>“Google <span>Earth Engine</span>: <span class="nocase">Planetary-scale</span> Geospatial Analysis for Everyone.”</span> <em>Remote Sensing of Environment</em>, Big <span>Remotely Sensed Data</span>: Tools, applications and experiences, 202 (December): 18–27. <a href="https://doi.org/10.1016/j.rse.2017.06.031">https://doi.org/10.1016/j.rse.2017.06.031</a>.
</div>
<div id="ref-hansen2013" class="csl-entry" role="listitem">
Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, et al. 2013. <span>“High-<span>Resolution Global Maps</span> of 21st-<span>Century Forest Cover Change</span>.”</span> <em>Science</em> 342 (6160): 850–53. <a href="https://doi.org/10.1126/science.1244693">https://doi.org/10.1126/science.1244693</a>.
</div>
<div id="ref-kumar2018" class="csl-entry" role="listitem">
Kumar, Lalit, and Onisimo Mutanga. 2018. <span>“Google <span>Earth Engine Applications Since Inception</span>: <span>Usage</span>, <span>Trends</span>, and <span>Potential</span>.”</span> <em>Remote Sensing</em> 10 (10, 10): 1509. <a href="https://doi.org/10.3390/rs10101509">https://doi.org/10.3390/rs10101509</a>.
</div>
<div id="ref-scheip2021" class="csl-entry" role="listitem">
Scheip, Corey M., and Karl W. Wegmann. 2021. <span>“<span>HazMapper</span>: A Global Open-Source Natural Hazard Mapping Application in <span>Google Earth Engine</span>.”</span> <em>Natural Hazards and Earth System Sciences</em> 21 (5): 1495–1511. <a href="https://doi.org/10.5194/nhess-21-1495-2021">https://doi.org/10.5194/nhess-21-1495-2021</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./4_policy_applications.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy Applications</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>