<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CASA0023 Remote Sensing - Learning Diary - 6&nbsp; Classification I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./7_classification_II.html" rel="next">
<link href="./5_google_earth_engine.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./6_classification_I.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CASA0023 Remote Sensing - Learning Diary</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Remote Sensing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_portfolio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Portfolio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_data_corrections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Remote Sensing Data and Corrections</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_policy_applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_google_earth_engine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_classification_I.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_classification_II.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_temperature_sar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Temperature/SAR</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-6-summary" id="toc-sec-6-summary" class="nav-link active" data-scroll-target="#sec-6-summary"><span class="header-section-number">6.1</span> Summary</a>
  <ul class="collapse">
  <li><a href="#sec-6-sum-class" id="toc-sec-6-sum-class" class="nav-link" data-scroll-target="#sec-6-sum-class"><span class="header-section-number">6.1.1</span> Classification</a></li>
  </ul></li>
  <li><a href="#sec-6-application" id="toc-sec-6-application" class="nav-link" data-scroll-target="#sec-6-application"><span class="header-section-number">6.2</span> Application</a></li>
  <li><a href="#sec-6-reflection" id="toc-sec-6-reflection" class="nav-link" data-scroll-target="#sec-6-reflection"><span class="header-section-number">6.3</span> Reflection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="sec-6-summary" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-6-summary"><span class="header-section-number">6.1</span> Summary</h2>
<p>This week we looked at how classification can help build important use cases for remote sensing. Starting with some practical use cases and then onto the theory and methods to produce outputs before practically applying this using Google Earth Engine. A recent example of remote sensing classification was that of the French authorities which identified undeclared private swimming pools and reclaimed €10m in revenue that otherwise wouldn’t have been possible (<span class="citation" data-cites="bbc2022">BBC (<a href="references.html#ref-bbc2022" role="doc-biblioref">2022</a>)</span>). The driver for this was in response to major drought, other use cases include illegal logging (<span class="citation" data-cites="gonzales2019">Gonzales (<a href="references.html#ref-gonzales2019" role="doc-biblioref">2019</a>)</span>) and forest fires (<span class="citation" data-cites="hansen2013">Hansen et al. (<a href="references.html#ref-hansen2013" role="doc-biblioref">2013</a>)</span>).</p>
<section id="sec-6-sum-class" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="sec-6-sum-class"><span class="header-section-number">6.1.1</span> Classification</h3>
<p>Traditionally there were two main forms of classification, according to <span class="citation" data-cites="abburu2015">Abburu and Babu Golla (<a href="references.html#ref-abburu2015" role="doc-biblioref">2015</a>)</span> these can be defined as:</p>
<ul>
<li><em>Supervised</em>: requires human input to build a training set with the accuracy highly dependent on the samples used for training . Techniques used include Support Vector Machine (SVM) and Random Forest.</li>
<li><em>Unsupervised</em>: uses clustering methods to group pixels into clusters then an analyst assigns labels to the clusters. Most commonly used techniques are ISODATA and K-means clustering.</li>
</ul>
<p>I had planned to conduct a comparison between supervised and unsupervised classification but <span class="citation" data-cites="gisgeography2016">GISGeography (<a href="references.html#ref-gisgeography2016" role="doc-biblioref">2016</a>)</span> have already produced a very good and clear summary of these methods (<a href="#fig-class-comp">Figure&nbsp;<span>6.1</span></a>).</p>
<div id="fig-class-comp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/classification_comparison.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.1: Table highlighting the differences between unsupervised and supervised classification. <strong>Source: <span class="citation" data-cites="gisgeography2016">GISGeography (<a href="references.html#ref-gisgeography2016" role="doc-biblioref">2016</a>)</span></strong></figcaption>
</figure>
</div>
<p>Picking out some key elements of this, the accuracy of supervised classification is usually more accurate due to the human input of the classification, however this presumes a level of knowledge of the study area in question which may not always be possible.</p>
<section id="sec-7-sum-obia" class="level4" data-number="6.1.1.1">
<h4 data-number="6.1.1.1" class="anchored" data-anchor-id="sec-7-sum-obia"><span class="header-section-number">6.1.1.1</span> Object Based Image Analysis</h4>
<p>These traditional classification techniques were orginally mainly used for pixel-based classifiction but since the late 1990s object based classification has become increasingly popular through Object Based Image Analysis (OBIA).</p>
<p>OBIA groups pixels into an object type which are then used as training data for the actual analysis. The basic steps for all these forms of classification are expertly summarised by <a href="#fig-classification-infographic">Figure&nbsp;<span>6.2</span></a> which also shows how OBIA has increased in popularity since 2008.</p>
<div id="fig-classification-infographic" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/image-classification-infographic.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.2: Image classification infographic depicting the steps of each classification method (supervised, unsupervised and Object Based Image Analysis), the timeline of their inception and the usage of each method between 2006 and 2013. Source: <span class="citation" data-cites="gisgeography2014">GISGeography (<a href="references.html#ref-gisgeography2014" role="doc-biblioref">2014</a>)</span></figcaption>
</figure>
</div>
<p>There is a clear trend of increased OBIA use from 2008 and it’s unfortunate that an updated version of this infographic is not available. However this does illustrate a shift toward OBIA, this is due to higher accuracy results and classifications especially in high-resolution imagery. This approach is more closely aligned to the human visual interpretation of images rather than a pixel based approach and the key to this is segmentation before classification takes place.</p>
</section>
</section>
</section>
<section id="sec-6-application" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-6-application"><span class="header-section-number">6.2</span> Application</h2>
<p>Image classification has a vast array of use cases as mentioned previously, however lets concentrate on to comparison between pixel-based approaches and object-based.</p>
<p>The pixel based approaches includes minimum distance and maximum likelihood algorithms whereas the segmentation approach used by OBIA allows for consideration of colour, scale and texture (<span class="citation" data-cites="amalisana2017">Amalisana, Rokhmatullah, and Hernina (<a href="references.html#ref-amalisana2017" role="doc-biblioref">2017</a>)</span>). Pixel based is often cited as producing a “salt and pepper” output which equates to more noise as individual pixels can be misclassified. Using the segmentation of OBIA this effect is greatly reduced and builds a clearer picture of how an area is built (<a href="#fig-pixel-v-object">Figure&nbsp;<span>6.3</span></a>). Here we can see how much clearer the classification of the object based approach is and particularly it’s accuracy at identifying the Cisadane river running through the city which is not visible at all in the pixel-based output. <span class="citation" data-cites="amalisana2017">Amalisana, Rokhmatullah, and Hernina (<a href="references.html#ref-amalisana2017" role="doc-biblioref">2017</a>)</span> state that pixel based classifications calculated that the accuracy of object based classification was 82.15% where as pixel based only 61.481% (see discussion on accuracy assessments in <a href="7_classification_II.html#sec-7-application"><span>Section&nbsp;7.2</span></a>).</p>
<div id="fig-pixel-v-object" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pixel_v_object_classification.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.3: Pixel-based versus object-based classification of Bogor City in 2016. Source:</figcaption>
</figure>
</div>
<p>For general land cover we’ve seen a clear example where OBIA out-performs pixel-based however there are other examples where pixel-based may be the preferred option. Picking the study of wetlands and the work of <span class="citation" data-cites="norris2024">Norris et al. (<a href="references.html#ref-norris2024" role="doc-biblioref">2024</a>)</span> where they found using Random Forest classifiers on both pixel and object-based approach that pixel-based was more accurate. This could be attribute to a few variables but most likely the small study area and the number of small-sized plants at the study sites. They also state the key importance of selection of input features, as an vegetation based study it is best to use the images at times of year where the vegetation is developed or flowering.</p>
<p>So whilst, OBIA appeared to be the obvious choice for classification we must always consider the use case as well as other variables such as image collection dates, spatial resolution and the specific study aims. Overall we must ensure that the use case is clearly defined before finalising methodology or perhaps compare the results ourselves in our research to ensure that the right option guides our decision making.</p>
</section>
<section id="sec-6-reflection" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-6-reflection"><span class="header-section-number">6.3</span> Reflection</h2>
<p>The practical session involved producing our first classified output with GEE. This proved troublesome with errors such as the <em>“Collection query aborted after accumulating over 5000 elements”</em>. There are many threads covering this with differing interpretations and I tried many different “solutions”. However after eventually consulting the GEE coding best practice I realised the issue was related to a print statement not the processing and whilst not ideal this didn’t affect the visualisation.</p>
<p>Moral of the story…..</p>
<div id="fig-debugging_meme" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/debugging_meme.webp" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.4: Debugging meme. Source: <span class="citation" data-cites="villalba2023">Villalba (<a href="references.html#ref-villalba2023" role="doc-biblioref">2023</a>)</span></figcaption>
</figure>
</div>
<p>I lost time troubleshooting the errors but this was a blessing as I dug deeper into the code and thus gained a better understanding. Eventually my first classification visualisation was produced (<a href="#fig-classification-output">Figure&nbsp;<span>6.5</span></a>) which appears close to real world but some refinement is needed. Notably a large part of the River Thames is classified as high urban, however this should be resolved by improving the training data.</p>
<div id="fig-classification-output" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/classification_output.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.5: My first classification output in Goggle Earth Engine</figcaption>
</figure>
</div>
<p>As GEE is so quick to train/run I updated the water training polygons and the output was more accurate (<a href="#fig-classification-output2">Figure&nbsp;<span>6.6</span></a>). However, this had the effect of now incorrectly classifying other water bodies. Continual retraining is needed to refine the output - perhaps by separating “standing water” and “flowing water” into individual training datasets. Despite this it really highlighted what a useful tool GEE is.</p>
<div id="fig-classification-output2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/classification_output2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;6.6: Retrained output improving the output of the River Thames</figcaption>
</figure>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-abburu2015" class="csl-entry" role="listitem">
Abburu, Sunitha, and Suresh Babu Golla. 2015. <span>“Satellite <span>Image Classification Methods</span> and <span>Techniques</span>: <span>A Review</span>.”</span> <em>International Journal of Computer Applications</em> 119 (8): 20–25. <a href="https://doi.org/10.5120/21088-3779">https://doi.org/10.5120/21088-3779</a>.
</div>
<div id="ref-amalisana2017" class="csl-entry" role="listitem">
Amalisana, Birohmatin, Rokhmatullah, and Revi Hernina. 2017. <span>“Land <span>Cover Analysis</span> by <span>Using Pixel-Based</span> and <span>Object-Based Image Classification Method</span> in <span>Bogor</span>.”</span> <em>IOP Conference Series: Earth and Environmental Science</em> 98 (1): 012005. <a href="https://doi.org/10.1088/1755-1315/98/1/012005">https://doi.org/10.1088/1755-1315/98/1/012005</a>.
</div>
<div id="ref-bbc2022" class="csl-entry" role="listitem">
BBC. 2022. <span>“Undeclared Pools in <span>France</span> Uncovered by <span>AI</span> Technology.”</span> <em>BBC News: Europe</em>, August 29, 2022. <a href="https://www.bbc.com/news/world-europe-62717599">https://www.bbc.com/news/world-europe-62717599</a>.
</div>
<div id="ref-gisgeography2014" class="csl-entry" role="listitem">
GISGeography. 2014. <span>“Image <span>Classification Techniques</span> in <span>Remote Sensing</span>.”</span> GIS Geography. May 2, 2014. <a href="https://gisgeography.com/image-classification-techniques-remote-sensing/">https://gisgeography.com/image-classification-techniques-remote-sensing/</a>.
</div>
<div id="ref-gisgeography2016" class="csl-entry" role="listitem">
———. 2016. <span>“Supervised and <span>Unsupervised Classification</span> in <span>Remote Sensing</span>.”</span> GIS Geography. June 30, 2016. <a href="https://gisgeography.com/supervised-unsupervised-classification-arcgis/">https://gisgeography.com/supervised-unsupervised-classification-arcgis/</a>.
</div>
<div id="ref-gonzales2019" class="csl-entry" role="listitem">
Gonzales, Jenny. 2019. <span>“How a Sheriff in <span>Brazil</span> Is Using Satellites to Stop Deforestation.”</span> Mongabay Environmental News. April 12, 2019. <a href="https://news.mongabay.com/2019/04/how-a-sheriff-in-brazil-is-using-satellites-to-stop-deforestation/">https://news.mongabay.com/2019/04/how-a-sheriff-in-brazil-is-using-satellites-to-stop-deforestation/</a>.
</div>
<div id="ref-hansen2013" class="csl-entry" role="listitem">
Hansen, M. C., P. V. Potapov, R. Moore, M. Hancher, S. A. Turubanova, A. Tyukavina, D. Thau, et al. 2013. <span>“High-<span>Resolution Global Maps</span> of 21st-<span>Century Forest Cover Change</span>.”</span> <em>Science</em> 342 (6160): 850–53. <a href="https://doi.org/10.1126/science.1244693">https://doi.org/10.1126/science.1244693</a>.
</div>
<div id="ref-norris2024" class="csl-entry" role="listitem">
Norris, Gregory S., Armand LaRocque, Brigitte Leblon, Myriam A. Barbeau, and Alan R. Hanson. 2024. <span>“Comparing <span>Pixel-</span> and <span>Object-Based Approaches</span> for <span>Classifying Multispectral Drone Imagery</span> of a <span>Salt Marsh Restoration</span> and <span>Reference Site</span>.”</span> <em>Remote Sensing</em> 16 (6, 6): 1049. <a href="https://doi.org/10.3390/rs16061049">https://doi.org/10.3390/rs16061049</a>.
</div>
<div id="ref-villalba2023" class="csl-entry" role="listitem">
Villalba, Fernando. 2023. <span>“Please <span>Kill RTFM</span>!”</span> Medium. July 6, 2023. <a href="https://nandovillalba.medium.com/platform-engineering-please-kill-rtfm-72de6f01075e">https://nandovillalba.medium.com/platform-engineering-please-kill-rtfm-72de6f01075e</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./5_google_earth_engine.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./7_classification_II.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification II</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>